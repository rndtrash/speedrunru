## Про БД

ER-диаграмма: 

Используется СУБД `PostgrSQL`.

Основная структура базы данных представлена на схеме:

![alt text](db-schema.svg "БД talent-management")

Сервис выполняет актуализацию структуры БД через миграции, используя [Liquibase](https://docs.liquibase.com/home.html).
Основная схема миграций находится в файле [change-log.yml](src/main/resources/db/changelog/change-log.yml). Форматом
миграции является схема `YAML`. Изменения, которые нельзя описать схемой выполняются через `SQL` скрипты.

Правила формирования миграций:

- Миграции должны быть привязаны к версии приложения до минорной (например, `2.3`, `2.5`), которая для миграций
  является директорией внутри `src/main/resources/db/changelog/changesets/`;
- Имя миграции должно быть по маске: `YYYYMMDD-HHMM-name`, где `YYYYMMDD-HHMM` &mdash; дата создания миграции,
  `name` &mdash; имя миграции;
- Должен быть указан автор миграции: фамилия, имя, адрес корпоративной почты;
- Должен быть указан комментарий о цели миграции;
- Для всех полей должны быть указаны комментарии;
- Создание таблиц разделать на отдельные миграции. Одна таблица &mdash; одна миграция;
- Создание индексов для разных таблиц разделять на разные миграции;
- Если необходимо выполнить произвольный SQL скрипт, то в нём необходимо соблюсти
  [форматирование](https://docs.liquibase.com/concepts/basic/sql-format.html).

Для правильной работы в реплицированной среде драйверу БД необходимо передать
[имя подключения приложения](https://jdbc.postgresql.org/documentation/use/#connection-parameters) в переменной
`ApplicationName` строки подключения (`spring.datasource.url`) к БД. Чтобы запросы отправлялись в правильную реплику.
Имя задаётся в настройке `tmbackend.jdbc-name` файла [настроек](config/tm-backend/application.yml). По умолчанию
равно имени сервиса `spring.application.name`.
